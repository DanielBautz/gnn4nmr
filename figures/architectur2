<mxfile host="app.diagrams.net" modified="2025-04-08T10:30:00.000Z" agent="Mozilla/5.0 (...)" etag="unique_etag" version="24.2.2" type="device">
  <diagram name="GNN Architecture" id="diagram_id">
    <mxGraphModel dx="1434" dy="780" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="input_data" value="Input: HeteroData Batch" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#fcba00;strokeColor=#000000;fontColor=#000000;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="310" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="input_x" value="x_dict&lt;br&gt;{'H': [N_h, in_dim_h],&lt;br&gt;'C': [N_c, in_dim_c],&lt;br&gt;'O': [N_o, in_dim_o]}" style="shape=note;size=15;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fcba00;strokeColor=#909085;" vertex="1" parent="1">
          <mxGeometry x="50" y="420" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="input_edge_idx" value="edge_index_dict&lt;br&gt;{ (src, 'bond', dst): [2, E_rel] }" style="shape=note;size=15;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fcba00;strokeColor=#909085;" vertex="1" parent="1">
          <mxGeometry x="50" y="530" width="160" height="70" as="geometry" />
        </mxCell>
        <mxCell id="input_edge_attr" value="edge_attr_dict&lt;br&gt;{ (src, 'bond', dst): [E_rel, edge_in_dim] }" style="shape=note;size=15;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fcba00;strokeColor=#909085;" vertex="1" parent="1">
          <mxGeometry x="50" y="610" width="160" height="70" as="geometry" />
        </mxCell>
        <mxCell id="encoder_group" value="Node Encoders" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#909085;dashed=1;verticalAlign=top;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="280" y="290" width="200" height="250" as="geometry" />
        </mxCell>
        <mxCell id="encoder_h" value="MLPEncoder (H)&lt;br&gt;(in_dim_h, hidden, out_dim)&lt;br&gt;Dropout: encoder_dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=12;" vertex="1" parent="encoder_group">
          <mxGeometry x="20" y="30" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="encoder_c" value="MLPEncoder (C)&lt;br&gt;(in_dim_c, hidden, out_dim)&lt;br&gt;Dropout: encoder_dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=12;" vertex="1" parent="encoder_group">
          <mxGeometry x="20" y="100" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="encoder_o" value="MLPEncoder (O)&lt;br&gt;(in_dim_o, hidden, out_dim)&lt;br&gt;Dropout: encoder_dropout" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=12;" vertex="1" parent="encoder_group">
          <mxGeometry x="20" y="170" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="edge_proc_cond" value="Edge Feature Processing&lt;br&gt;(if GINEConv / NNConv)" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fcba00;strokeColor=#000000;fontColor=#000000;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="290" y="610" width="180" height="80" as="geometry" />
        </mxCell>
        <mxCell id="edge_proj" value="Linear Edge Projection&lt;br&gt;(edge_in_dim, out_dim)&lt;br&gt;*Only for GINEConv*" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="520" y="615" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="gnn_block" value="HeteroGNN Layers&lt;br&gt;num_gnn_layers x (&lt;br&gt;  HeteroConv(op=operator_type, aggr='sum')&lt;br&gt;  ReLU()&lt;br&gt;  Dropout(gnnlayer_dropout)&lt;br&gt;)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=14;align=left;spacingLeft=10;" vertex="1" parent="1">
          <mxGeometry x="510" y="340" width="300" height="140" as="geometry" />
        </mxCell>
        <mxCell id="pred_head_group" value="Prediction Heads" style="rounded=1;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#909085;dashed=1;verticalAlign=top;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="870" y="330" width="160" height="160" as="geometry" />
        </mxCell>
        <mxCell id="pred_h" value="Linear (H)&lt;br&gt;(out_dim, 1)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=12;" vertex="1" parent="pred_head_group">
          <mxGeometry x="20" y="30" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="pred_c" value="Linear (C)&lt;br&gt;(out_dim, 1)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#004e9f;strokeColor=#000000;fontColor=#ffffff;fontSize=12;" vertex="1" parent="pred_head_group">
          <mxGeometry x="20" y="90" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="output_h" value="Predicted Shift (H)&lt;br&gt;[N_h_valid, 1]" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#fcba00;strokeColor=#000000;fontColor=#000000;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1070" y="342.5" width="140" height="65" as="geometry" />
        </mxCell>
        <mxCell id="output_c" value="Predicted Shift (C)&lt;br&gt;[N_c_valid, 1]" style="shape=parallelogram;perimeter=parallelogramPerimeter;whiteSpace=wrap;html=1;fixedSize=1;fillColor=#fcba00;strokeColor=#000000;fontColor=#000000;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="1070" y="422.5" width="140" height="65" as="geometry" />
        </mxCell>
        <mxCell id="arrow_input_h_encoder" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="input_x" target="encoder_h">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="220" y="470" as="sourcePoint" />
            <mxPoint x="300" y="350" as="targetPoint" />
            <Array as="points">
              <mxPoint x="250" y="470" />
              <mxPoint x="250" y="350" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow_input_c_encoder" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="input_x" target="encoder_c">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="220" y="470" as="sourcePoint" />
            <mxPoint x="300" y="420" as="targetPoint" />
             <Array as="points">
              <mxPoint x="250" y="470" />
              <mxPoint x="250" y="420" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow_input_o_encoder" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="input_x" target="encoder_o">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="220" y="470" as="sourcePoint" />
            <mxPoint x="300" y="490" as="targetPoint" />
             <Array as="points">
              <mxPoint x="250" y="470" />
              <mxPoint x="250" y="490" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow_input_edge_proc" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="input_edge_attr" target="edge_proc_cond">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
         <mxCell id="arrow_edge_proc_proj" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="edge_proc_cond" target="edge_proj">
          <mxGeometry relative="1" as="geometry">
             <Array as="points">
                <mxPoint x="470" y="650" />
              </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow_edge_proj_gnn" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="edge_proj" target="gnn_block">
          <mxGeometry relative="1" as="geometry">
             <mxPoint x="600" y="550" as="sourcePoint"/>
             <Array as="points">
              <mxPoint x="595" y="550" />
              <mxPoint x="660" y="550" />
              <mxPoint x="660" y="480" />
            </Array>
          </mxGeometry>
        </mxCell>
         <mxCell id="arrow_edge_proc_gnn_direct" value="Pass edge_attr for NNConv" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;fontSize=10;dashed=1;" edge="1" parent="1" source="edge_proc_cond" target="gnn_block">
          <mxGeometry relative="1" as="geometry">
             <mxPoint x="400" y="550" as="sourcePoint"/>
             <Array as="points">
               <mxPoint x="380" y="550" />
               <mxPoint x="660" y="550" />
               <mxPoint x="660" y="480" />
             </Array>
           </mxGeometry>
        </mxCell>
        <mxCell id="arrow_encoder_h_gnn" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="encoder_h" target="gnn_block">
          <mxGeometry relative="1" as="geometry">
             <Array as="points">
               <mxPoint x="490" y="350" />
               <mxPoint x="490" y="410" />
             </Array>
           </mxGeometry>
        </mxCell>
         <mxCell id="arrow_encoder_c_gnn" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="encoder_c" target="gnn_block">
          <mxGeometry relative="1" as="geometry">
             <mxPoint x="490" y="420" as="sourcePoint"/>
              <Array as="points">
               <mxPoint x="490" y="420" />
               <mxPoint x="490" y="410" />
             </Array>
           </mxGeometry>
        </mxCell>
         <mxCell id="arrow_encoder_o_gnn" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="encoder_o" target="gnn_block">
          <mxGeometry relative="1" as="geometry">
             <mxPoint x="490" y="490" as="sourcePoint"/>
              <Array as="points">
               <mxPoint x="490" y="490" />
               <mxPoint x="490" y="410" />
             </Array>
           </mxGeometry>
        </mxCell>
         <mxCell id="arrow_input_edgeidx_gnn" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;dashed=1;" edge="1" parent="1" source="input_edge_idx" target="gnn_block">
           <mxGeometry relative="1" as="geometry">
              <mxPoint x="220" y="565" as="sourcePoint"/>
              <Array as="points">
                <mxPoint x="400" y="565" />
                <mxPoint x="400" y="410" />
              </Array>
           </mxGeometry>
        </mxCell>
         <mxCell id="arrow_gnn_predh" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="gnn_block" target="pred_h">
           <mxGeometry relative="1" as="geometry">
              <mxPoint x="810" y="410" as="sourcePoint"/>
               <Array as="points">
                 <mxPoint x="840" y="410" />
                 <mxPoint x="840" y="385" />
               </Array>
            </mxGeometry>
         </mxCell>
          <mxCell id="arrow_gnn_predc" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="gnn_block" target="pred_c">
           <mxGeometry relative="1" as="geometry">
              <mxPoint x="810" y="410" as="sourcePoint"/>
               <Array as="points">
                 <mxPoint x="840" y="410" />
                 <mxPoint x="840" y="445" />
               </Array>
            </mxGeometry>
         </mxCell>
         <mxCell id="arrow_predh_outh" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="pred_h" target="output_h">
           <mxGeometry relative="1" as="geometry" />
         </mxCell>
         <mxCell id="arrow_predc_outc" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#909085;endArrow=classic;endFill=1;" edge="1" parent="1" source="pred_c" target="output_c">
           <mxGeometry relative="1" as="geometry" />
         </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
